server {
    listen 80;
    listen [::]:80;
    root  /var/www/html;

    # Phpmyadmin Configurations
    location /phpmyadmin {
        index index.php index.html index.htm;
    }

    # Dealing with the uppercased letters
    location /phpMyAdmin {
        rewrite ^/* /phpmyadmin last;
    }

    location / {
        index index.php index.html index.htm;
    }

    location /asnan {
        root  /var/www/html/payroll/websites;
        index index.php index.html index.htm;
    }

    location /cusmo {
        root  /var/www/html/payroll/websites;
        index index.php index.html index.htm;
    }

    location /course {
        root  /var/www/html/course_dashboard/websites;
        index index.php index.html index.htm;
    }

    location /course_site {
        root  /var/www/html/courses/websites;
        index index.php index.html index.htm;
    }

    location ~ \.php$ {
        include snippets/fastcgi-php.conf;

        # Nginx php-fpm sock config:
        fastcgi_pass unix:/run/php/php8.1-fpm.sock;
        # Nginx php-cgi config :
        # Nginx PHP fastcgi_pass 127.0.0.1:9000;
    }

    # deny access to Apache .htaccess on Nginx with PHP,
    # if Apache and Nginx document roots concur
    location ~ /\.ht {
        deny all;
    }

    location /rest{
        proxy_pass http://127.0.0.1:8080;
        proxy_http_version 1.1; # Important, do not omit
    }

    location /rest_cusmo{
        proxy_pass http://127.0.0.1:3030;
        proxy_http_version 1.1; # Important, do not omit
    }

    location /rest_course{
        proxy_pass http://127.0.0.1:2020;
           proxy_http_version 1.1;
           proxy_request_buffering off;
           client_max_body_size 0;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header Host $http_host;

           # Set the maximum temporary file size to the maximum of the
           # buffer sizes to avoid errors.
           proxy_max_temp_file_size 1m;
           proxy_buffer_size 32k;
           proxy_busy_buffers_size 64k;
           proxy_buffers 4 32k;
           proxy_temp_file_write_size 256k;
           limit_rate                  10m;
    }

    location /upload {
      proxy_pass http://127.0.0.1:2020;
      proxy_http_version 1.1;
    }

}
